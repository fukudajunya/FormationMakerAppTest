<script>
  function preventFormSubmit() {
    var forms = document.querySelectorAll('form');
      for (var i = 0; i < forms.length; i++) {
        forms[i].addEventListener('submit', function(event) {
        event.preventDefault();
        });
      }
        //.gs内のloading()を呼び出し、読み込み後にListBack()でselect要素に選択肢を設定します。
      google.script.run.withSuccessHandler(ListBack).loading(); 
    }

    window.addEventListener('load', preventFormSubmit);

    //リスト読み込み
    function ListBack(data) {
      //他関数でも読めるようにグローバル変数としてセット
      listdata = data;
      var list = document.getElementById('list');
      for (var i=0; i<data.length; i++){
        var option = document.createElement('option');
        option.setAttribute('value', data[i][0]);
        option.innerHTML = data[i][0];
        list.appendChild(option);
      }
    }
    
    // 参加者一覧が配列で取得できたので、それをクライアントに表示させる関数
    function EventParticipant(data){
       // aタグの初期化を毎回行う
       var participant = document.getElementById('event-paricipant');
       console.log(participant.hasChildNodes());
       while(participant.firstChild){
         participant.removeChild(participant.firstChild);
       }
       for(var i=0; i<data.length; i++){
         // aタグを追加する
         var a = document.createElement("a");
         a.setAttribute('class', 'circle');
         a.id = "participant" + i; 
         a.textContent = data[i];
         a.style.fontSize = '1px';
         var participantBox = participant.appendChild(a);
       }
       $(function() {
         $('.circle').draggable();
       });
    }
    
    // 「選択完了」ボタンを押下したときのアクション
    function clickBtn(){
	  const event = document.getElementById("list").value;
      // イベント管理シートを読み込んでlistを返す関数を呼び出し、さらに結果をコールバック関数の「EventParticipant」に渡す
      google.script.run.withSuccessHandler(EventParticipant).showEventParticipant(event);

  	  document.getElementById("event-name").textContent = event;
    }
    
    // 踊り子追加ダイアログを表示する
//    function addDancer(){
//      ret = confirm("Googleへ移動します。よろしいですか？");
//      if (ret == true){
//        location.href = "http://www.google.co.jp/";
//      }
//    }
      /** inputして分岐するパターンを記載
      $(function(){
        $('#addDancer').button()
        .click(function(){
          $('#add-dancer-dialog').dialog({resizable:false, modal:true,
            buttons:{
              "追加": function(){},
              "キャンセル": function(){
                $("#dd-dancer-name").val("");
                $(this).dialog("close");
              }
            }
          });
        });
      });
      **/
      
      /** モーダルテスト **/
      $(function(){
        $('.login_btn').click(function(){
          $('#signup_modal').fadeIn();
        });
        $('.close_icon').click(function(){
          $('#signup_modal').fadeOut();
        });
        $('.submit_btn').click(function(){
          $('#signup_modal').fadeOut();
        });
      });
</script>